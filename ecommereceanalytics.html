<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>E-Commerce Analytics & Forecasting | Power BI Project</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
<!-- Prism.js SQL Syntax Highlighting -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>


  <style>
    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background-color: #f5f7fa;
      color: #333;
    }

    .container-custom {
      width: 95%;
      max-width: 1400px;
      margin: auto;
      padding: 30px 0 30px;
    }

    .dashboard {
      width: 100%;
      height: calc(100vh - 130px);
      border: none;
      border-radius: 10px;
      box-shadow: 0 6px 14px rgba(0,0,0,0.15);
    }

    .section-title {
    text-align: center;
    font-size: 24px;   /* optional */
    font-weight: bold; /* optional */
    margin-bottom: 20px; /* optional spacing */
padding: 30px 0 30px;
  }

    .code-container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .code-block {
      flex: 1;
      min-width: 320px;
   background: #020617;
 
      color: #e5e7eb;
      border-radius: 10px;
      padding: 16px;
      height: 460px;
      overflow-y: auto;
      box-shadow: 0 6px 14px rgba(0,0,0,0.2);
    }

    .code-block h3 {
      margin-top: 0;
      margin-bottom: 10px;
      font-size: 18px;
      color: #38bdf8;
    }

    pre {
      margin: 0;
      font-size: 14px;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .code-block::-webkit-scrollbar {
      width: 8px;
    }
.code-block pre {
  background: transparent;
}

    .code-block::-webkit-scrollbar-thumb {
      background: #475569;
      border-radius: 4px;
    }

    .code-block::-webkit-scrollbar-track {
      background: #020617;
    }
.image-row {
  display: flex;
  justify-content: center; /* center the images as a group */
  gap: 20px;               /* space between images */
  margin-top: 30px;
      flex-wrap: wrap;
}

.image-row img {
  max-width: 100%; /* prevents overflow on small screens */
  height: auto;
}


.project-summary {
  margin-top: 70px;
  padding: 60px 30px;
  background: #ffffff;
  border-radius: 14px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.08);
}

.project-summary h2 {
  text-align: center;
  font-size: 32px;
  font-weight: 800;
  margin-bottom: 40px;
}

.project-summary h3 {
  text-align: center;
  font-size: 22px;
  font-weight: 700;
  margin-top: 40px;
  margin-bottom: 16px;
  color: #1f2937;
}

.project-summary p {
  max-width: 900px;
  margin: auto;
  font-size: 16px;
  line-height: 1.7;
  text-align: center;
  color: #374151;
}

.skill-badges {
  max-width: 1000px;
  margin: 20px auto 0;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
}

.skill-badges span {
  padding: 8px 14px;
  background: #f1f5f9;
  border-radius: 999px;
  font-size: 14px;
  font-weight: 600;
  color: #0f172a;
  border: 1px solid #e2e8f0;
}

.workflow {
  max-width: 1000px;
  margin: auto;
  font-size: 16px;
  line-height: 1.8;
  text-align: center;
  color: #374151;
}

.impact-list {
  max-width: 800px;
  margin: auto;
  padding-left: 0;
  list-style: none;
  text-align: center;
}

.impact-list li {
  margin: 10px 0;
  font-size: 16px;
}
  </style>
</head>

<body>

<!-- ================= HEADER ================= -->
<header id="main-header" class="sticky top-0 z-50 shadow-md bg-gray-900">
  <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
    
    <div class="text-2xl font-black tracking-wider text-white">
      Mohsan<span class="text-orange-400">BI</span>
    </div>

    <!-- Desktop Menu -->
    <div class="hidden md:flex items-center space-x-8">
      <a class="font-bold text-gray-300 hover:text-orange-400" href="https://mohsanbi.github.io/portfolio/#about">About</a>
      <a class="font-bold text-gray-300 hover:text-orange-400" href="https://mohsanbi.github.io/portfolio/#projects">Projects</a>
      <a class="font-bold text-gray-300 hover:text-orange-400" href="https://mohsanbi.github.io/portfolio/#contact">Contact</a>
      <a class="font-bold text-gray-300 hover:text-orange-400" href="https://mohsanbi.github.io/portfolio/#faqs">FAQs</a>

      <a class="block text-lg font-bold text-transparent bg-clip-text
         bg-gradient-to-r from-yellow-600 via-yellow-400 to-yellow-200
         hover:from-yellow-400 hover:via-yellow-200 hover:to-yellow-500"
         href="https://mohsanbi.github.io/portfolio/#awards">
        Awards
      </a>

      <a class="px-5 py-2 border-2 border-orange-400 text-orange-400 rounded-full
         hover:bg-orange-400 hover:text-white transition-all"
         href="https://drive.google.com/file/d/1Ku26nJ-bovann6yBeqkMlceESG3ZOXTr/view?usp=sharing"
         target="_blank">
        CV
      </a>
    </div>

    <!-- Contact CTA -->
    <a class="hidden md:block px-5 py-2 bg-orange-500 text-white rounded-full
       hover:bg-orange-600 transform hover:scale-105 transition-all shadow-md"
       href="/#contact">
      Contact
    </a>

    <!-- Mobile Button -->
    <div class="md:hidden">
      <button id="mobile-menu-button" class="text-white text-2xl">
        ☰
      </button>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden bg-gray-800 text-center py-4 md:hidden">
    <a class="block py-2 text-white hover:bg-gray-700" href="https://mohsanbi.github.io/portfolio/#about">About</a>
    <a class="block py-2 text-white hover:bg-gray-700" href="https://mohsanbi.github.io/portfolio/#projects">Projects</a>
    <a class="block py-2 text-white hover:bg-gray-700" href="https://mohsanbi.github.io/portfolio/#contact">Contact</a>
    <a class="block py-2 text-white hover:bg-gray-700" href="https://mohsanbi.github.io/portfolio/#faqs">FAQs</a>
    <a class="block py-2 text-white hover:bg-gray-700" href="https://mohsanbi.github.io/portfolio/#awards">Awards</a>
    <a class="block mt-4 mx-4 px-6 py-2 font-bold border border-white text-white rounded-md hover:bg-orange-600"
       href="https://drive.google.com/file/d/1Ku26nJ-bovann6yBeqkMlceESG3ZOXTr/view?usp=sharing"
       target="_blank">
      CV
    </a>
  </div>
</header>

<!-- ================= CONTENT ================= -->
<div class="container-custom">
<div class="section-title">E-Commerece Analytics and Forcasting</div>

  <!-- Power BI Dashboard -->
  <iframe
    class="dashboard"
    title="E Commerce Analytics & Forecasting"
    src="https://app.powerbi.com/view?r=eyJrIjoiM2ViZGMwNjgtNmIzYS00ZTkyLThhODYtYzNiZTJiMTRlYmNlIiwidCI6ImNlY2ZmMzY1LWU1MDktNGE4Mi05NzAxLTZmMDI5ZGM0ZTdkOCIsImMiOjl9"
    allowfullscreen="true">
  </iframe>

  <!-- SQL Section -->
  <div class="section-title">PostgreSQL Data Modeling & Transformation</div>

  <div class="code-container">

    <div class="code-block">
      <h3>staging.sql</h3>
      <pre><code class="language-sql">
-- Customers
CREATE TABLE staging_customers (
    customer_id VARCHAR,
    customer_unique_id VARCHAR,
    customer_zip_code_prefix VARCHAR,
    customer_city VARCHAR,
    customer_state VARCHAR
);

-- Sellers
CREATE TABLE staging_sellers (
    seller_id VARCHAR,
    seller_zip_code_prefix VARCHAR,
    seller_city VARCHAR,
    seller_state VARCHAR
);

-- Products
CREATE TABLE staging_products (
    product_id VARCHAR,
    product_category_name VARCHAR,
    product_name_lenght VARCHAR,
    product_description_lenght VARCHAR,
    product_photos_qty VARCHAR,
    product_weight_g VARCHAR,
    product_length_cm VARCHAR,
    product_height_cm VARCHAR,
    product_width_cm VARCHAR
);

-- Orders
CREATE TABLE staging_orders (
    order_id VARCHAR,
    customer_id VARCHAR,
    order_status VARCHAR,
    order_purchase_timestamp VARCHAR,
    order_approved_at VARCHAR,
    order_delivered_carrier_date VARCHAR,
    order_delivered_customer_date VARCHAR,
    order_estimated_delivery_date VARCHAR
);

-- Order Items
CREATE TABLE staging_order_items (
    order_id VARCHAR,
    order_item_id VARCHAR,
    product_id VARCHAR,
    seller_id VARCHAR,
    shipping_limit_date VARCHAR,
    price VARCHAR,
    freight_value VARCHAR
);

-- Payments
CREATE TABLE staging_payments (
    order_id VARCHAR,
    payment_sequential VARCHAR,
    payment_type VARCHAR,
    payment_installments VARCHAR,
    payment_value VARCHAR
);

-- Reviews
CREATE TABLE staging_reviews (
    review_id VARCHAR,
    order_id VARCHAR,
    review_score VARCHAR,
    review_comment_title VARCHAR,
    review_comment_message VARCHAR,
    review_creation_date VARCHAR,
    review_answer_timestamp VARCHAR
);

-- Geolocation
CREATE TABLE staging_geolocation (
    geolocation_zip_code_prefix VARCHAR,
    geolocation_lat VARCHAR,
    geolocation_lng VARCHAR,
    geolocation_city VARCHAR,
    geolocation_state VARCHAR
);

      </code></pre>
    </div>

    <div class="code-block">
      <h3>mart.sql</h3>
      <pre><code class="language-sql">
CREATE TABLE dim_customer AS
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    INITCAP(customer_city)        AS customer_city,
    customer_state
FROM staging_customers;


CREATE TABLE dim_product AS
SELECT
    product_id,
    category,

    CASE
        WHEN product_name_lenght ~ '^[0-9]+$'
        THEN product_name_lenght::INT
        ELSE NULL
    END AS product_name_length,

    CASE
        WHEN product_description_lenght ~ '^[0-9]+$'
        THEN product_description_lenght::INT
        ELSE NULL
    END AS product_description_length,

    CASE
        WHEN product_photos_qty ~ '^[0-9]+$'
        THEN product_photos_qty::INT
        ELSE NULL
    END AS product_photos_qty,

    CASE
        WHEN product_weight_g ~ '^[0-9]+(\.[0-9]+)?$'
        THEN product_weight_g::NUMERIC
        ELSE NULL
    END AS product_weight_g,

    CASE
        WHEN product_length_cm ~ '^[0-9]+(\.[0-9]+)?$'
        THEN product_length_cm::NUMERIC
        ELSE NULL
    END AS product_length_cm,

    CASE
        WHEN product_height_cm ~ '^[0-9]+(\.[0-9]+)?$'
        THEN product_height_cm::NUMERIC
        ELSE NULL
    END AS product_height_cm,

    CASE
        WHEN product_width_cm ~ '^[0-9]+(\.[0-9]+)?$'
        THEN product_width_cm::NUMERIC
        ELSE NULL
    END AS product_width_cm

FROM staging_products;





CREATE TABLE dim_seller AS
SELECT
    seller_id,
    seller_zip_code_prefix,
    INITCAP(seller_city) AS seller_city,
    seller_state
FROM staging_sellers;



CREATE TABLE dim_orders AS
SELECT Distinct
	order_id,
    customer_id,
    order_status,

    CASE
            WHEN order_purchase_timestamp ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}'
            THEN TO_TIMESTAMP(order_purchase_timestamp, 'YYYY-MM-DD HH24:MI:SS')
            ELSE NULL
        END AS order_date,

	

FROM staging_orders;



CREATE TABLE dim_location AS
SELECT DISTINCT
    geolocation_zip_code_prefix,
    MIN(geolocation_city) AS city,
    geolocation_state
FROM staging_geolocation
GROUP BY geolocation_zip_code_prefix, geolocation_state;




CREATE TABLE dim_date AS
SELECT DISTINCT
    order_date::DATE AS date_key,

    EXTRACT(YEAR FROM order_date)    AS year,
    EXTRACT(MONTH FROM order_date)   AS month,
    EXTRACT(DAY FROM order_date)     AS day,
    EXTRACT(QUARTER FROM order_date) AS quarter,

    TO_CHAR(order_date, 'Day')   AS day_name,
    TO_CHAR(order_date, 'Month') AS month_name

FROM (
    SELECT
        CASE
            WHEN order_purchase_timestamp ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}'
            THEN TO_TIMESTAMP(order_purchase_timestamp, 'YYYY-MM-DD HH24:MI:SS')
            ELSE NULL
        END AS order_date
    FROM staging_orders
) t
WHERE order_date IS NOT NULL;




CREATE TABLE fact_sales AS
SELECT
    o.order_id,

    CASE
        WHEN oi.order_item_id ~ '^[0-9]+$'
        THEN oi.order_item_id::INT
        ELSE NULL
    END AS order_item_id,
    c.customer_unique_id,
    o.customer_id,
    oi.product_id,
    oi.seller_id,

    -- Order Date
    CASE
        WHEN o.order_purchase_timestamp ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}'
        THEN TO_TIMESTAMP(o.order_purchase_timestamp, 'YYYY-MM-DD HH24:MI:SS')::DATE
        ELSE NULL
    END AS order_date,

	CASE
            WHEN order_approved_at ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}'
            THEN TO_TIMESTAMP(order_approved_at, 'YYYY-MM-DD HH24:MI:SS')
            ELSE NULL
        END AS order_approved_date,
	
	CASE
            WHEN order_delivered_carrier_date ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}'
            THEN TO_TIMESTAMP(order_delivered_carrier_date, 'YYYY-MM-DD HH24:MI:SS')
            ELSE NULL
        END AS dispatch_date,

	CASE
            WHEN order_delivered_customer_date ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}'
            THEN TO_TIMESTAMP(order_delivered_customer_date, 'YYYY-MM-DD HH24:MI:SS')
            ELSE NULL
        END AS delivered_date,

		
	CASE
            WHEN order_estimated_delivery_date ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}'
            THEN TO_TIMESTAMP(order_estimated_delivery_date, 'YYYY-MM-DD HH24:MI:SS')
            ELSE NULL
        END AS Estimated_delivery_date,


    -- Measures
    CASE
        WHEN oi.price ~ '^[0-9]+(\.[0-9]+)?$'
        THEN oi.price::NUMERIC
        ELSE NULL
    END AS item_price,

    CASE
        WHEN oi.freight_value ~ '^[0-9]+(\.[0-9]+)?$'
        THEN oi.freight_value::NUMERIC
        ELSE NULL
    END AS freight_value,

    -- Total Revenue
    (
        CASE
            WHEN oi.price ~ '^[0-9]+(\.[0-9]+)?$'
            THEN oi.price::NUMERIC
            ELSE 0
        END
        +
        CASE
            WHEN oi.freight_value ~ '^[0-9]+(\.[0-9]+)?$'
            THEN oi.freight_value::NUMERIC
            ELSE 0
        END
    ) AS total_item_revenue,

    o.order_status

FROM staging_orders o
JOIN staging_order_items oi
    ON o.order_id = oi.order_id 
JOIN staging_customers c    
	ON o.customer_id = c.customer_id;




CREATE TABLE fact_payments AS
SELECT
    order_id,

    CASE
        WHEN payment_sequential ~ '^[0-9]+$'
        THEN payment_sequential::INT
        ELSE NULL
    END AS payment_sequential,

    payment_type,

    CASE
        WHEN payment_installments ~ '^[0-9]+$'
        THEN payment_installments::INT
        ELSE NULL
    END AS payment_installments,

    CASE
        WHEN payment_value ~ '^[0-9]+(\.[0-9]+)?$'
        THEN payment_value::NUMERIC
        ELSE NULL
    END AS payment_value

FROM staging_payments;




CREATE TABLE fact_reviews AS
SELECT
    review_id,
    order_id,

    CASE
        WHEN review_score ~ '^[0-9]+$'
        THEN review_score::INT
        ELSE NULL
    END AS review_score,

    CASE
        WHEN review_creation_date ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}'
        THEN TO_TIMESTAMP(review_creation_date, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS review_creation_date,

    CASE
        WHEN review_answer_timestamp ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}'
        THEN TO_TIMESTAMP(review_answer_timestamp, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS review_answer_timestamp

FROM staging_reviews;


     </code> </pre>
    </div>

  </div>
<div class="section-title">Power BI Screenshots</div>
<div class="image-row">
  <img src="https://res.cloudinary.com/dnotuemwj/image/upload/v1766303609/Ecommerece_Data_Model_nsfeoc.png" loading="lazy" decoding="async" alt="Image 1">
</div>

<!-- ================= PROJECT HIGHLIGHTS ================= -->
<section class="project-summary">

  <h2>Project Highlights</h2>

  <h3>Tools & Skills</h3>
  <div class="skill-badges">
    <span>PostgreSQL</span>
    <span>SQL</span>
    <span>Power BI</span>
    <span>DAX</span>
    <span>Data Modeling</span>
    <span>Star Schema</span>
    <span>Data Cleaning</span>
    <span>Cohort Analysis</span>
    <span>Business Analytics</span>
    <span>Dashboard Design</span>
  </div>

  <h3>Project Purpose</h3>
  <p>
    To build an end-to-end business intelligence solution that transforms raw
    e-commerce transactional data into decision-ready insights for sales,
    marketing, and leadership teams.
  </p>

  <h3>Project Workflow</h3>
  <p class="workflow">
    CSV data ingested into PostgreSQL staging tables → Regex-based safe casting
    and SQL transformations → BI-ready fact & dimension tables (Star Schema) →
    Power BI data modeling → Executive dashboards and KPI reporting.
  </p>

  <h3>Business Impact</h3>
  <ul class="impact-list">
    <li>Enabled visibility into revenue, orders, AOV, and customer retention</li>
    <li>Identified top-performing products, sellers, and regions</li>
    <li>Analyzed repeat customer behavior and cohort retention trends</li>
    <li>Improved understanding of customer satisfaction via review analysis</li>
  </ul>

  <h3>Source of Data</h3>
  <p>
    Olist Brazilian E-Commerce Public Dataset (real-world transactional data)
  </p>

</section>


</div>

<!-- ================= JS ================= -->
<script>
  const menuButton = document.getElementById("mobile-menu-button");
  const mobileMenu = document.getElementById("mobile-menu");

  menuButton.addEventListener("click", () => {
    mobileMenu.classList.toggle("hidden");
  });
</script>

</body>
</html>


